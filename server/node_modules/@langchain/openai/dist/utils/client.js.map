{"version":3,"file":"client.js","names":[],"sources":["../../src/utils/client.ts"],"sourcesContent":["import { APIConnectionTimeoutError, APIUserAbortError } from \"openai\";\nimport { ContextOverflowError } from \"@langchain/core/errors\";\nimport { addLangChainErrorFields } from \"./errors.js\";\n\nfunction _isOpenAIContextOverflowError(e: object): boolean {\n  const errorStr = String(e);\n  if (errorStr.includes(\"context_length_exceeded\")) {\n    return true;\n  }\n  if (\n    \"message\" in e &&\n    typeof e.message === \"string\" &&\n    (e.message.includes(\"Input tokens exceed the configured limit\") ||\n      e.message.includes(\"exceeds the context window\"))\n  ) {\n    return true;\n  }\n  return false;\n}\n\nexport function wrapOpenAIClientError(e: unknown) {\n  if (!e || typeof e !== \"object\") {\n    return e;\n  }\n\n  let error;\n  if (\n    e.constructor.name === APIConnectionTimeoutError.name &&\n    \"message\" in e &&\n    typeof e.message === \"string\"\n  ) {\n    error = new Error(e.message);\n    error.name = \"TimeoutError\";\n  } else if (\n    e.constructor.name === APIUserAbortError.name &&\n    \"message\" in e &&\n    typeof e.message === \"string\"\n  ) {\n    error = new Error(e.message);\n    error.name = \"AbortError\";\n  } else if (_isOpenAIContextOverflowError(e)) {\n    error = ContextOverflowError.fromError(e as Error);\n  } else if (\n    \"status\" in e &&\n    e.status === 400 &&\n    \"message\" in e &&\n    typeof e.message === \"string\" &&\n    e.message.includes(\"tool_calls\")\n  ) {\n    error = addLangChainErrorFields(e, \"INVALID_TOOL_RESULTS\");\n  } else if (\"status\" in e && e.status === 401) {\n    error = addLangChainErrorFields(e, \"MODEL_AUTHENTICATION\");\n  } else if (\"status\" in e && e.status === 429) {\n    error = addLangChainErrorFields(e, \"MODEL_RATE_LIMIT\");\n  } else if (\"status\" in e && e.status === 404) {\n    error = addLangChainErrorFields(e, \"MODEL_NOT_FOUND\");\n  } else {\n    error = e;\n  }\n  return error;\n}\n"],"mappings":";;;;;AAIA,SAAS,8BAA8B,GAAoB;AAEzD,KADiB,OAAO,EAAE,CACb,SAAS,0BAA0B,CAC9C,QAAO;AAET,KACE,aAAa,KACb,OAAO,EAAE,YAAY,aACpB,EAAE,QAAQ,SAAS,2CAA2C,IAC7D,EAAE,QAAQ,SAAS,6BAA6B,EAElD,QAAO;AAET,QAAO;;AAGT,SAAgB,sBAAsB,GAAY;AAChD,KAAI,CAAC,KAAK,OAAO,MAAM,SACrB,QAAO;CAGT,IAAI;AACJ,KACE,EAAE,YAAY,SAAS,0BAA0B,QACjD,aAAa,KACb,OAAO,EAAE,YAAY,UACrB;AACA,UAAQ,IAAI,MAAM,EAAE,QAAQ;AAC5B,QAAM,OAAO;YAEb,EAAE,YAAY,SAAS,kBAAkB,QACzC,aAAa,KACb,OAAO,EAAE,YAAY,UACrB;AACA,UAAQ,IAAI,MAAM,EAAE,QAAQ;AAC5B,QAAM,OAAO;YACJ,8BAA8B,EAAE,CACzC,SAAQ,qBAAqB,UAAU,EAAW;UAElD,YAAY,KACZ,EAAE,WAAW,OACb,aAAa,KACb,OAAO,EAAE,YAAY,YACrB,EAAE,QAAQ,SAAS,aAAa,CAEhC,SAAQ,wBAAwB,GAAG,uBAAuB;UACjD,YAAY,KAAK,EAAE,WAAW,IACvC,SAAQ,wBAAwB,GAAG,uBAAuB;UACjD,YAAY,KAAK,EAAE,WAAW,IACvC,SAAQ,wBAAwB,GAAG,mBAAmB;UAC7C,YAAY,KAAK,EAAE,WAAW,IACvC,SAAQ,wBAAwB,GAAG,kBAAkB;KAErD,SAAQ;AAEV,QAAO"}